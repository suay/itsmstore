jQuery(function(c){c("#ywsbs_safe_submit_field").val(""),c("#ywsbs_schedule_subscription_button").on("click",function(s){s.preventDefault(),c("#ywsbs_safe_submit_field").val("schedule_subscription"),c(this).closest("form").submit()}),0<c(document).find(".wp-heading-inline").length&&c('<div class="view-all-subs"><a href="'+ywsbs_subscription_admin.url_back_to_all_subscription+'"> < '+ywsbs_subscription_admin.back_to_all_subscription+"</a></div>").insertBefore(".wp-heading-inline"),c(document).on("click","a.edit_address",function(s){s.preventDefault();var e=c(this),i=e.closest(".subscription_data_column").find("div.edit_address"),t=e.closest(".subscription_data_column").find("a");e.closest(".subscription_data_column").find("div.address").toggle(),t.toggle(),i.toggle()});c(document).on("click",".load_customer_info",function(s){s.preventDefault();var e=c(this);!function(e,i,s){var t=e===i?"load_"+e:"copy_billing";if(!0===s||window.confirm(ywsbs_subscription_admin[t])){var n=c("#user-id").val();if(0===n)return window.alert(ywsbs_subscription_admin.no_customer_selected);var o={user_id:n,action:"woocommerce_get_customer_details",security:ywsbs_subscription_admin.get_customer_details_nonce};c.ajax({url:ywsbs_subscription_admin.ajaxurl,data:o,type:"POST",success:function(s){console.log(s),s&&s[e]&&c.each(s[e],function(s,e){c("#_"+i+"_"+s).val(e).change()})}})}}(e.data("from"),e.data("to"))}),c.fn.datetimepicker!==undefined&&c(document).find(".ywsbs-timepicker").each(function(){c(this).prop("placeholder","YYYY-MM-DD HH:mm")}).datetimepicker({timeFormat:"HH:mm:ss",defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,showSeconds:!1}),c(document).find(".ui-datepicker").addClass("yith-plugin-fw-datepicker-div"),c("#ywsbs_schedule_subscription_button").on("click",function(s){s.preventDefault(),c("#ywsbs_safe_submit_field").val("schedule_subscription"),c(this).closest("form").submit()});var e={init:function(){var s=c(document).find("#woocommerce-order-items");s.on("click","a.edit-order-item",this.edit_item),s.on("click",".save-action",this.save_items),s.on("click",".recalculate-action",this.recalculate)},edit_item:function(){return c(this).closest("tr").find(".view").hide(),c(this).closest("tr").find(".edit").show(),c(this).hide(),c(".wc-order-add-item").show(),c(".wc-order-recalculate").hide(),c("button.cancel-action").attr("data-reload",!0),!1},save_items:function(){var s={subscription_id:c("#post_ID").val(),items:c("table.woocommerce_order_items :input[name], .wc-order-totals-items :input[name]").serialize(),action:"ywsbs_save_items",security:ywsbs_subscription_admin.save_item_nonce};return c.ajax({url:ywsbs_subscription_admin.ajaxurl,data:s,type:"POST",beforeSend:function(){c("#woocommerce-order-items").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},success:function(s){c("#ywsbs-product-subscription").find(".inside").empty().append(s),c("#woocommerce-order-items").unblock(),e.init()}}),!1},recalculate:function(){var s={subscription_id:c("#post_ID").val(),action:"ywsbs_recalculate",security:ywsbs_subscription_admin.recalculate_nonce};c.ajax({url:ywsbs_subscription_admin.ajaxurl,data:s,type:"POST",beforeSend:function(){c("#woocommerce-order-items").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},success:function(s){c("#ywsbs-product-subscription").find(".inside").empty().append(s),c("#woocommerce-order-items").unblock(),e.init()}})}};function t(){return c(document).find(".ywsbs-delivery-schedules-table").DataTable({searching:!0,ordering:!1,language:{lengthMenu:ywsbs_subscription_admin.datatable_lengthMenu+" _MENU_"}})}e.init(),0<c(".ywsbs-export").length&&(c(".wp-header-end").before(c(".ywsbs-export")),c(".ywsbs-export").css({display:"inline-block"}));var n=t();c(document).on("change","#ywsbs-delivery-schedules-status",function(){n.columns(1).search(this.value).draw()});var r=function(s,i){c.ajax({url:ywsbs_subscription_admin.ajaxurl,data:s,type:"POST",beforeSend:function(){i.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},success:function(s){if("undefined"==typeof s.error){var e=c("#ywsbs-delivery-schedules-status").val();i.unblock(),i.closest(".inside").html(s),n.destroy,n=t(),e&&c("#ywsbs-delivery-schedules-status").val(e).change()}}})};c(document).on("change",".status-hover",function(){var s=c(this),e=s.val(),i=s.closest(".status-td"),t=i.data("id"),n=c("#yith-shipped-confirm"),o={action:"ywsbs_update_delivery_status",security:ywsbs_subscription_admin.delivery_nonce,deliveryID:t,status:e,subscriptionID:c("#post_ID").val()},a={};a[ywsbs_subscription_admin["continue"]]=function(){r(o,i),n.dialog("close")},a[ywsbs_subscription_admin.cancel]=function(){n.dialog("close")},"shipped"===e?n.dialog({width:450,modal:!0,dialogClass:"ywsbs-shipped-confirm",buttons:a}):r(o,i)})});