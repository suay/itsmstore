jQuery(function(e){var i=e("#billing_country");billingCompany=e("#billing_company"),billingType=e("input[name='billing_receiver_type']"),billingReceiverID=e("#billing_receiver_id"),billingReceiverPec=e("#billing_receiver_pec"),billingReceiverVatNumber=e("#billing_vat_number"),billingReceiverVatSSN=e("#billing_vat_ssn"),billingInvoiceType=e("#billing_invoice_type"),validateFields(),billingType.on("change",function(){validateFields()}),billingReceiverID.on("input",function(){validateFields()}),billingReceiverPec.on("input",function(){validateFields()}),billingReceiverVatNumber.on("input",function(){validateFields()}),billingInvoiceType.on("change",function(){validateFields()}),"yes"!=ywpi_checkout.is_ssn_mandatory&&billingReceiverVatSSN.on("input",function(){validateFields()}),e("#billing_vat_ssn").on("focusout",function(e){validate_ssn_field("ssn",jQuery(this).val())}),i.on("change",function(){validateFields()})});var validateFields=function(){var e=jQuery("#billing_country"),i=jQuery("#billing_company"),l=(jQuery("#billing_receiver_type"),jQuery("#billing_receiver_id")),o=jQuery("#billing_receiver_pec"),n=jQuery("#billing_vat_number"),r=jQuery("#billing_vat_ssn"),t=jQuery("input[name='billing_receiver_type']:checked").val(),a=jQuery("#billing_invoice_type");"company"==t?jQuery("#billing_invoice_type_field").hide():jQuery("#billing_invoice_type_field").show(),"undefined"!==t&&-1!==jQuery.inArray(t,["company","freelance"])?(i.closest(".form-row").show(),"company"==t?(jQuery("#billing_invoice_type_field").hide(),jQuery('#billing_invoice_type_field option[value="receipt"]').removeAttr("selected"),jQuery('#billing_invoice_type_field option[value="invoice"]').attr("selected","selected"),setFieldAsRequired(i)):(jQuery("#billing_invoice_type_field").show(),setFieldAsNotRequired(i)),"IT"==e.val()?(l.closest(".form-row").show(),o.closest(".form-row").show(),""!=l.val()&&""==o.val()?(setFieldAsNotRequired(o),l.closest(".form-row").find(".optional").remove()):""==l.val()&&""!=o.val()?(setFieldAsNotRequired(l),o.closest(".form-row").find(".optional").remove()):""==l.val()&&""==o.val()&&(setFieldAsRequired(l),setFieldAsRequired(o)),"yes"!=ywpi_checkout.is_vat_mandatory&&setFieldAsRequired(n),"yes"!=ywpi_checkout.is_ssn_mandatory&&setFieldAsNotRequired(r)):("yes"!=ywpi_checkout.is_vat_mandatory&&setFieldAsNotRequired(n),"yes"!=ywpi_checkout.is_ssn_mandatory&&setFieldAsNotRequired(r),setFieldAsNotRequired(l,"no"),setFieldAsNotRequired(o,"no"))):(setFieldAsNotRequired(l,"no"),setFieldAsNotRequired(o,"no"),"yes"!=ywpi_checkout.is_vat_mandatory&&setFieldAsNotRequired(n,"no"),"yes"!=ywpi_checkout.is_ssn_mandatory&&("IT"===(e=e.val())&&void 0===a.val()||"IT"===e&&void 0!==a.val()&&"invoice"===a.val()||"IT"===e&&ywpi_checkout.receipt_ssn_mandatory?setFieldAsRequired:setFieldAsNotRequired)(r),i.closest(".form-row").hide())},setFieldAsRequired=function(e){0!=e.closest(".form-row").find(".optional").length&&(e.closest(".form-row").find(".optional").remove(),e.closest(".form-row").find("label").append('<abbr class="required" title="required">*</abbr>')),e.closest(".form-row").show(),""==e.val()&&e.closest(".form-row").addClass("validate-required woocommerce-invalid woocommerce-invalid-required-field")},setFieldAsNotRequired=function(e,i="yes"){var l='<span class="optional">'+ywpi_checkout.optional_label+"</span>";0==e.closest(".form-row").find(".optional").length&&(e.closest(".form-row").find("abbr").remove(),e.closest(".form-row").find("label").append(l)),e.closest(".form-row").removeClass("validate-required woocommerce-invalid woocommerce-invalid-required-field"),"no"==i&&e.closest(".form-row").removeClass("validate-required woocommerce-invalid woocommerce-invalid-required-field").hide()};function CheckCodiceFiscale(e){var i,l,o,n;if(""==e)return"";if(16!=(e=e.toUpperCase()).length)return"La lunghezza del codice fiscale non è\ncorretta: il codice fiscale dovrebbe essere lungo\nesattamente 16 caratteri.\n";for(i=0;i<16;i++)if(-1=="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".indexOf(e.charAt(i)))return"Il codice fiscale contiene caratteri non validi `"+e.charAt(i)+"'.\nI caratteri peril codice fiscale sono lettere e cifre.\n";for(o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n="ABCDEFGHIJABCDEFGHIJKLMNOPQRSTUVWXYZ",l=0,i=1;i<=13;i+=2)l+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(n.charAt(o.indexOf(e.charAt(i))));for(i=0;i<=14;i+=2)l+="BAKPLCQDREVOSFTGUHMINJWZYX".indexOf(n.charAt(o.indexOf(e.charAt(i))));return l%26!=e.charCodeAt(15)-"A".charCodeAt(0)?"Il codice fiscale è errato":""}function validate_ssn_field(e,i){"private"===jQuery("input[name=billing_receiver_type]:checked").val()&&""!=CheckCodiceFiscale(i)&&alert("Il codice fiscale inserito non è corretto")}